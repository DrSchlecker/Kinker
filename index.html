<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Question Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        .card {
            border: 1px solid #000;
            padding: 20px;
            margin: 20px;
            display: inline-block;
        }
        .buttons {
            margin-top: 20px;
        }
        /* Animation for match highlight */
        @keyframes matchHighlight {
            0% { background-color: white; }
            50% { background-color: yellow; }
            100% { background-color: white; }
        }
        .matched {
            animation: matchHighlight 2s ease-in-out;
        }
        #match-stack-container {
            margin-top: 30px;
        }
        #loading-spinner {
            display: none;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <h1>Question Game</h1>

    <!-- Nickname input field -->
    <div>
        <label for="nickname">Enter your nickname:</label>
        <input type="text" id="nickname-input" placeholder="Nickname">
        <button id="save-nickname-button">Save Nickname</button>
    </div>
    
     <div>
        <h3>Select a game mode</h3>
        <button id="mode1-button">Mode 1: Same questions for both players</button>
        <button id="mode2-button">Mode 2: Different questions for both players</button>
        
        <!-- Session code display for Player 1 -->
        <p id="session-code-display" style="display:none;">Session Code: <span id="session-code"></span></p>
        
        <!-- Input and button for Player 2 to join a game using the session code -->
        <input type="text" id="join-game-code" placeholder="Enter Session Code" style="display:none;">
        <button id="join-game-button" style="display:none;">Join Game with Code</button>
    </div>
    
    <!-- Loading spinner for waiting -->
    <div id="loading-spinner" style="display:none;">
        <img src="spinner.gif" alt="Loading...">
    </div>


    <div id="card-container" style="display:none;">
        <div class="card" id="question-card">The question will be displayed here</div>
        <div class="buttons">
            <button id="yes-button">Yes</button>
            <button id="no-button">No</button>
        </div>
    </div>

    <div>
        <h2>Game Progress</h2>
        <p id="info">Waiting for response...</p>
        <button id="reset-button" style="display:none;">Reset Deck</button>
        <button id="full-reset-button" style="display:block;">Full Reset</button>
    </div>

    <!-- Area for match stack -->
    <div id="match-stack-container">
        <h2>Match Stack</h2>
        <div id="match-stack"></div>
    </div>

    <!-- Player nicknames and current game info -->
    <div id="game-info" style="margin-top: 20px;">
        <h3>Current Game</h3>
        <p>Players: <span id="player-names"></span></p>
        <p id="session-code-display"></p>
    </div>

    <!-- Loading spinner -->
    <div id="loading-spinner">
        <img src="spinner.gif" alt="Loading...">
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC7ATp5cSVxkLNvKU5ZS0nFLEY63jWaZJU",
            authDomain: "kinker-2024.firebaseapp.com",
            databaseURL: "https://kinker-2024-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "kinker-2024",
            storageBucket: "kinker-2024.appspot.com",
            messagingSenderId: "986360648193",
            appId: "1:986360648193:web:065d171dc2c5354d7ee600"
        };

        // Initialize Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        } else {
            firebase.app(); // Use existing app
        }

        const database = firebase.database();

        // Function to write data to Firebase
        function writeData(player, answer) {
            firebase.database().ref('answers/' + player).set({
                answer: answer
            }).catch(error => {
                console.error("Error writing data:", error);
            });
        }

        // Function to read data from Firebase and listen for changes
        function readData() {
            const dbRef = firebase.database().ref();
            firebase.database().ref('answers').on('value', (snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    console.log("Current answers: ", data);
                } else {
                    console.log("No data available.");
                }
            }, error => {
                console.error("Error reading data:", error);
            });
        }

        // Call readData on page load to sync with Firebase
        readData();
    </script>

    <!-- Game logic script -->
    <script src="script.js"></script>

</body>
</html>
